{"id":"cp-sync-5mh","title":"Consider switching CCB events to event_profiles endpoint for full venue addresses","description":"## Context\nCurrently using `public_calendar_listing` endpoint which only provides venue name as a string. The `event_profiles` endpoint provides full location objects with complete address data.\n\n## Current State\n✅ Code handles both formats gracefully\n✅ Venues import with names from `public_calendar_listing`\n⚠️ No street address, city, state, zip data available\n\n## Potential Enhancement\nSwitch from `public_calendar_listing` to `event_profiles` endpoint to get:\n- venue name\n- street_address  \n- city\n- state\n- zip\n\n## Considerations\n**public_calendar_listing:**\n- ✅ Filters by date range (date_start, date_end)\n- ✅ Returns event occurrences\n- ❌ Location is string only (no address)\n\n**event_profiles:**\n- ✅ Full location object with addresses\n- ✅ Official documented endpoint\n- ⚠️ Filters by modified_since (not date ranges)\n- ⚠️ Returns master events (not occurrences)\n\n## Action Items\n- [ ] Evaluate if date-range vs modified_since filtering works for use case\n- [ ] Test event_profiles endpoint integration\n- [ ] Consider hybrid approach (fetch list from public_calendar_listing, get details from event_profile by ID)\n- [ ] Update admin settings to allow endpoint selection\n\n## Files to Modify\n- `includes/ChMS/CCB.php` - fetch_events() method (line ~631)\n\n## Note\nNo urgent action needed - venues are importing correctly with available data. This is an enhancement opportunity when full addresses are desired.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-30T12:07:28.346397-06:00","created_by":"tannermoushey","updated_at":"2026-01-30T12:07:28.346397-06:00"}
{"id":"cp-sync-ijx","title":"Fix CCB event venue import to support location data","description":"## Problem\nCCB events were importing but venues had no location/address data.\n\n## Investigation\n- CCB API has two event endpoints:\n  - `public_calendar_listing`: Returns location as simple string (venue name only)\n  - `event_profiles`: Returns location as nested object with full address details\n\n## Solution\nUpdated location normalization in both `/includes/ChMS/CCB.php` and `/includes/ChMS/cli/CCB.php` to handle both formats:\n\n1. **String format** (public_calendar_listing): Extracts venue name\n2. **Object format** (event_profiles): Extracts name + street_address, city, state, zip\n\n## Changes Made\n- Updated `normalize_ccb_event()` to detect and handle both location formats\n- Enhanced `format_event()` to create venues with all available address data\n- Updated CLI commands to display location information properly\n- Added logging for venue creation\n\n## Result\n✅ Venues now import correctly with venue names\n✅ Code ready to support full addresses when using event_profiles endpoint\n✅ Gracefully handles both minimal and complete location data\n\n## Files Modified\n- `includes/ChMS/CCB.php`\n- `includes/ChMS/cli/CCB.php`","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T12:06:32.625841-06:00","created_by":"tannermoushey","updated_at":"2026-01-30T12:06:36.692647-06:00","closed_at":"2026-01-30T12:06:36.692647-06:00","close_reason":"Closed"}
